<html>
<head>
<!--
		<script type="text/javascript" src="Dojo Toolkit/dojo-release-1.7.1/dojo/dojo.js" djconfig="parseOnLoad: true, isDebug: true" >
		</script> 
		<link href="Dojo Toolkit/dojo-release-1.7.1/dijit/themes/claro/claro.css" rel="stylesheet">
-->
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8" /> 
    <title>Teste Promise v2.0</title>
	<link href="../dojo1.7.1/dijit/themes/claro/claro.css" rel="stylesheet"> 
	<!--<link type="text/css" rel="stylesheet" href="Mother1/bootstrap.css" />--> <!-- efeito de halo -->
	<link rel="stylesheet" href="Mother1/font-awesome.css">	
	<script type="text/javascript" src="../dojo1.7.1/dojo/dojo.js" djconfig="parseOnLoad: true, isDebug: true" ></script> 
	<script src="Mother1/jquery-1.8.1.min.js"></script>
	<!--<script src="Mother1/bootstrap.js"></script>-->	
	<link href="../dojo1.7.1/dijit/themes/claro/claro.css" rel="stylesheet"> 
	<!--<link href="Dojo Toolkit/dojo-release-1.7.1/dojox/layout/resources/ResizeHandle.css " rel="stylesheet">-->
	<link rel="stylesheet" href="../dgrid/css/dgrid.css">  
	<!------ Mother CSS ----------------------------------------------------------------- -->
		<!--- For Mother Builder --->
		<link rel="stylesheet" type="text/css" href="Mother1/MotherBuilder.css" /> 
		<!--- For Mother Forms  A -BlueHills, B-Simple Green C- Tree D-Chess E-light blue F(A+C)=>(fz,f0)-->
		<!-- <link rel="stylesheet" type="text/css" href="Mother1/MotherF.css"/> --> 
	<!-- ----------------------------------------------------------------------------------- -->
	<!--	<link href="Dojo Toolkit/dojo-release-1.7.1/dijit/themes/claro/claro.css" rel="stylesheet">-->

<script>
oDbg=null;
//thiz=this;
require([
	"Mother1/utils.js",
	"Mother1/debug.js",
	"Mother1/editFBuilder2.js",
	"MotherLib6.js",
	"dojo/_base/Deferred",
	"dojo/_base/declare",	 
	"dojo/_base/window",
    "dojo/on",
	"dojo/parser",//recomendation from JS
	"dojo/dom",
	"dojo/dom-construct",//used outside class
	"dojo/dom-style",	
	"dojo/ready",
	//----- para editFBuilder on,Lang,DomGeom
    "dojo/_base/lang",
	"dojo/dom-geometry",
	"dojo/Evented" //necessário para emit e recepção de eventos
	], 
	function(Utils,Dbg,EditFBuilder,FBuilder,Deferred,Declare,Win,On,Parser,Dom,DomConstruct,DomStyle,Ready,Lang,DomGeom,Evented){ 
		//----------- debug preparation Area -----------------------------------------------------------
		this.oDbg=new Dbg();
		this.oDbg.setDbg("test_promise"          ,"",{"main":true});//All debugs in this class with these keywords will be send to console.log
		//this.oDbg.setDbg("MotherLib6"          ,"-->",{"addChild":false,"JSON_Default_dgrid":true,setFieldStyle:true});//All debugs in this class with these keywords will be send to console.log
		//this.oDbg.setDbg("editFBuilder2"       ,"-->",{"constructor":true,"setAListeners":false,"resumeWListeners":true,suspendWListeners:true,"overWidget":true,"outWidget":true});
		//this.oDbg.setDbg("ResizeMoveArea"      ,"---->",{"constructor":true,"activate":true,"afterMoving":true});//All debugs in this class with these keywords will be send to console.log

		this.oDbg.setThis("test_promise");
		//------------------------------------------------------------------------
		if(this.oDbg.isDbg("main")) this.oDbg.display(document.title+"......  BEGIN..");//document title tem a property <title> que está no head
		if(this.oDbg.isDbg("main")) this.oDbg.display(document.title+"......  BEGIN CLASS TEST..");
		//------------------------------------------------------------------------	
		//write code HERE !
		//setTimeout(function(){alert("Hello after 5 seconds....")},5000);
		// setTimeout(function(){
		// 	console.log("immediatly before Hello");
		// 	alert("Hello after 5 seconds....");
		// },5000);
		// console.log("setTimeOut was already launched");
		function someDeferredFunction() {
			var deferred = new Deferred();
	    	setTimeout(function() {
	    		console.log("3-immediatly before resolve (ex: callback)");
	            //deferred.callback(42); 
	            deferred.resolve(42); 
	        }, 5000);
	    	return deferred;      
		};
		console.log("1-before defining def")
		var def = someDeferredFunction();
		//Then we can subscribe to both its success and failure cases by using the then function.
		def.then(
		    // Success
		    function(value) {
		        alert("Then method - 5 seconds later on we get the resolve (ex: callback) value="+value);
		    },
		    // Failure
		    function(error) {
		        alert(error);
		    });
		console.log("2-after the definition !!!")
		//--------------------------------------------------------------------------------------------------------------------------
		if(this.oDbg.isDbg("main")) this.oDbg.display(document.title+"......  END..");//document title tem  a property <title> que está no head
	}//closing of main function				
);//closing of require function
</script>
	</head>
	<body class="claro">
		<div id="xwrapper" </div>
	</body>
</html>
